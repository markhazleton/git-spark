{"key":"azure-devops:pr:46166","data":{"repository":{"id":"79303015-efbb-4f81-8835-a6e8ed8821de","name":"bsw.category","url":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de","project":{"id":"44bf0711-d4a8-47a6-b9e2-113462d4062a","name":"HealthSource","state":"unchanged","visibility":"unchanged","lastUpdateTime":"0001-01-01T00:00:00"}},"pullRequestId":46166,"codeReviewId":46166,"status":"completed","createdBy":{"displayName":"Addala, NagaDurga Sai","url":"https://spsprodeus27.vssps.visualstudio.com/Ae2f412ee-0ceb-4474-bf67-439832da0ed3/_apis/Identities/1c37b8ff-033c-6453-b40e-21e51deb1848","_links":{"avatar":{"href":"https://dev.azure.com/bswdev/_apis/GraphProfile/MemberAvatars/aad.MWMzN2I4ZmYtMDMzYy03NDUzLWI0MGUtMjFlNTFkZWIxODQ4"}},"id":"1c37b8ff-033c-6453-b40e-21e51deb1848","uniqueName":"NAA1975A@BSWHealth.org","imageUrl":"https://dev.azure.com/bswdev/_api/_common/identityImage?id=1c37b8ff-033c-6453-b40e-21e51deb1848","descriptor":"aad.MWMzN2I4ZmYtMDMzYy03NDUzLWI0MGUtMjFlNTFkZWIxODQ4"},"creationDate":"2025-10-16T17:39:00.6691793Z","closedDate":"2025-10-20T15:17:53.8185184Z","title":"feat: Add comprehensive Kusto logging to classify endpoints","description":"**Overview**\nThis PR implements unified Kusto logging for both FCN classification and category management endpoints, transitioning from separate request/response log entries to single combined entries with comprehensive timing and activity tracking.\n\n**Key Changes**\n1. Core Logging Infrastructure (app/core/kusto_logger.py)\nAdded create_fcn_classify_combined_activity() for single combined log entri","sourceRefName":"refs/heads/kusto-logging","targetRefName":"refs/heads/main","mergeStatus":"succeeded","isDraft":false,"mergeId":"79b18f43-1d87-4b7c-a4d3-bbc7fe4099dd","lastMergeSourceCommit":{"commitId":"51bd725bff6e792fc1403e223b1e67e82a2279b7","url":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/commits/51bd725bff6e792fc1403e223b1e67e82a2279b7"},"lastMergeTargetCommit":{"commitId":"c7cdc6c27f5e60b07b26b46296021ac90a433335","url":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/commits/c7cdc6c27f5e60b07b26b46296021ac90a433335"},"lastMergeCommit":{"commitId":"d195b8e82af3dc739fe9e11d3c03375b8f3ae3cb","url":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/commits/d195b8e82af3dc739fe9e11d3c03375b8f3ae3cb"},"reviewers":[{"reviewerUrl":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/pullRequests/46166/reviewers/1c37b8ff-033c-6453-b40e-21e51deb1848","vote":10,"hasDeclined":false,"isFlagged":false,"displayName":"Addala, NagaDurga Sai","url":"https://spsprodeus27.vssps.visualstudio.com/Ae2f412ee-0ceb-4474-bf67-439832da0ed3/_apis/Identities/1c37b8ff-033c-6453-b40e-21e51deb1848","_links":{"avatar":{"href":"https://dev.azure.com/bswdev/_apis/GraphProfile/MemberAvatars/aad.MWMzN2I4ZmYtMDMzYy03NDUzLWI0MGUtMjFlNTFkZWIxODQ4"}},"id":"1c37b8ff-033c-6453-b40e-21e51deb1848","uniqueName":"NAA1975A@BSWHealth.org","imageUrl":"https://dev.azure.com/bswdev/_api/_common/identityImage?id=1c37b8ff-033c-6453-b40e-21e51deb1848"},{"reviewerUrl":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/pullRequests/46166/reviewers/bccb4a00-c898-4d77-bea0-67a988ce57b7","vote":10,"hasDeclined":false,"isRequired":true,"isFlagged":false,"displayName":"Harwood, Anthony J","url":"https://spsprodeus27.vssps.visualstudio.com/Ae2f412ee-0ceb-4474-bf67-439832da0ed3/_apis/Identities/bccb4a00-c898-4d77-bea0-67a988ce57b7","_links":{"avatar":{"href":"https://dev.azure.com/bswdev/_apis/GraphProfile/MemberAvatars/aad.MWFjZDM3ODEtZDI3Yy03MGQ1LWE0ZWUtZTFmNThkMTVhMmJm"}},"id":"bccb4a00-c898-4d77-bea0-67a988ce57b7","uniqueName":"e69975@bswhealth.org","imageUrl":"https://dev.azure.com/bswdev/_api/_common/identityImage?id=bccb4a00-c898-4d77-bea0-67a988ce57b7"},{"reviewerUrl":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/pullRequests/46166/reviewers/239ca11f-c913-66a3-915c-c5d290163ee8","vote":10,"hasDeclined":false,"isRequired":true,"isFlagged":false,"displayName":"Hazleton, Mark","url":"https://spsprodeus27.vssps.visualstudio.com/Ae2f412ee-0ceb-4474-bf67-439832da0ed3/_apis/Identities/239ca11f-c913-66a3-915c-c5d290163ee8","_links":{"avatar":{"href":"https://dev.azure.com/bswdev/_apis/GraphProfile/MemberAvatars/aad.MjM5Y2ExMWYtYzkxMy03NmEzLTkxNWMtYzVkMjkwMTYzZWU4"}},"id":"239ca11f-c913-66a3-915c-c5d290163ee8","uniqueName":"MAH0190@BSWHealth.org","imageUrl":"https://dev.azure.com/bswdev/_api/_common/identityImage?id=239ca11f-c913-66a3-915c-c5d290163ee8"},{"reviewerUrl":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/pullRequests/46166/reviewers/3e174804-7594-678a-812c-cec1b000675f","vote":0,"hasDeclined":false,"isFlagged":false,"displayName":"Rane, Pramod","url":"https://spsprodeus27.vssps.visualstudio.com/Ae2f412ee-0ceb-4474-bf67-439832da0ed3/_apis/Identities/3e174804-7594-678a-812c-cec1b000675f","_links":{"avatar":{"href":"https://dev.azure.com/bswdev/_apis/GraphProfile/MemberAvatars/aad.M2UxNzQ4MDQtNzU5NC03NzhhLTgxMmMtY2VjMWIwMDA2NzVm"}},"id":"3e174804-7594-678a-812c-cec1b000675f","uniqueName":"PRR2003@BSWHealth.org","imageUrl":"https://dev.azure.com/bswdev/_api/_common/identityImage?id=3e174804-7594-678a-812c-cec1b000675f"}],"url":"https://dev.azure.com/bswdev/44bf0711-d4a8-47a6-b9e2-113462d4062a/_apis/git/repositories/79303015-efbb-4f81-8835-a6e8ed8821de/pullRequests/46166","completionOptions":{"mergeCommitMessage":"Merged PR 46166: feat: Add comprehensive Kusto logging to classify endpoints\n\n**Overview**\nThis PR implements unified Kusto logging for both FCN classification and category management endpoints, transitioning from separate request/response log entries to single combined entries with comprehensive timing and activity tracking.\n\n**Key Changes**\n1. Core Logging Infrastructure (app/core/kusto_logger.py)\nAdded create_fcn_classify_combined_activity() for single combined log entries\nAdded create_category_management_combined_activity() for category operations\nApplication name differentiation: fcn.classify vs fcn.category\nAutomatic duration calculation from ActivityStart to ActivityEnd\nCombined data structure with request and response data in ActivityDetailsJson\nBackward compatibility maintained with deprecated function markers\n2. FCN Classify Endpoints (app/api/routes/classify_routes.py)\nMigrated all endpoints to combined logging pattern\nEnhanced request tracking: input, language, agent_name, URL, input_length\nComprehensive response data: intent, token_count, duration, classify_id, status\nComplete error scenario coverage: HTTP errors, general errors, agent not found\nEndpoints updated: /classify, /classify/{agent_name}, /classify-intent, /classify-intent/{agent_name}\n3. Category Management Endpoints (app/api/routes/category_management_routes.py)\nAdded comprehensive combined logging to all 5 CRUD operations\nConverted all endpoints from def to async def for proper async logging support\nOperations covered: create, get, list, update, delete\nComplete error handling: not found, conflicts, validation errors, general errors\nApplication name correctly set to fcn.category\n\n**Benefits\nOperational**\nSingle log entry per request eliminates duplication\nComplete timing data with ActivityStart, ActivityEnd, and calculated duration\nEnhanced traceability with session and correlation ID tracking\nClear application segregation between classify and category operations\n**Technical**\nFire-and-forget async logging doesn't block API responses\nStructured JSON format for both request and response data\nAll error scenarios properly logged with context\nBackground task execution for optimal performance\n**Testing Completed**\nAll FCN.CLASSIFY endpoints tested and working\nAll FCN.CATEGORY endpoints tested and working\nError scenarios verified (validation, authentication, not found)\nAsync compatibility confirmed for fire-and-forget logging\nKusto log verification showing single combined entries\nApplication name differentiation confirmed\nActivity codes verified: classify.{action}.{status} and category.{action}.{status}\n\nRelated work items: #327460","deleteSourceBranch":true,"squashMerge":true,"mergeStrategy":"squash","autoCompleteIgnoreConfigIds":[]},"supportsIterations":true,"completionQueueTime":"2025-10-20T15:17:52.8014721Z"},"createdAt":1760979241118,"expiresAt":1761065641118,"lastAccessedAt":1760979241118,"accessCount":1,"dataSize":8784}